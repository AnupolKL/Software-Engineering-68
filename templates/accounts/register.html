{% extends "base.html" %}
{% load static %}

{% block title %}สมัครสมาชิก | CUTCAMP{% endblock %}

{% block content %}
<div class="max-w-md mx-auto p-8 bg-[#2a3731] rounded-2xl shadow-xl">
  <div class="bg-white/5 rounded-xl p-6">
    <h1 class="text-2xl font-extrabold text-white mb-2">สมัครสมาชิก</h1>

    <form method="post" class="styled-form space-y-4">
      {% csrf_token %}
      {{ form.non_field_errors }}

      <div>
        <label class="block text-sm text-gray-200 mb-1">ชื่อผู้ใช้</label>
        {{ form.username }}
        {% for e in form.username.errors %}<p class="text-rose-500 text-xs mt-1">{{ e }}</p>{% endfor %}
      </div>

      <div>
        <label class="block text-sm text-gray-200 mb-1">เบอร์โทร</label>
        {{ form.phone }}
        {% for e in form.phone.errors %}<p class="text-rose-500 text-xs mt-1">{{ e }}</p>{% endfor %}
      </div>

      <div>
        <label class="block text-sm text-gray-200 mb-1">อีเมล</label>
        {{ form.email }}
        {% for e in form.email.errors %}<p class="text-rose-500 text-xs mt-1">{{ e }}</p>{% endfor %}
      </div>

      <div class="relative">
        <label class="block text-sm text-gray-200 mb-1">รหัสผ่าน</label>
        {{ form.password1 }}
        <button type="button" id="toggle-pass1" class="absolute right-3 top-9 text-gray-400 text-sm">แสดง</button>
        {% for e in form.password1.errors %}<p class="text-rose-500 text-xs mt-1">{{ e }}</p>{% endfor %}
      </div>

      <div class="relative">
        <label class="block text-sm text-gray-200 mb-1">ยืนยันรหัสผ่าน</label>
        {{ form.password2 }}
        <button type="button" id="toggle-pass2" class="absolute right-3 top-9 text-gray-400 text-sm">แสดง</button>
        {% for e in form.password2.errors %}<p class="text-rose-500 text-xs mt-1">{{ e }}</p>{% endfor %}
      </div>

      <button class="w-full inline-flex items-center justify-center gap-2 px-4 py-3 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-semibold transition">
        สมัครสมาชิก
      </button>

      <p class="text-sm text-gray-300 text-center">มีบัญชีแล้ว? <a class="text-blue-400 hover:text-blue-300" href="{% url 'login' %}">เข้าสู่ระบบ</a></p>
    </form>
  </div>

  <style>
    .styled-form input[type="text"],
    .styled-form input[type="email"],
    .styled-form input[type="password"],
    .styled-form input[type="tel"] {
      width: 100%;
      padding: 0.75rem 0.75rem;
      border-radius: 0.5rem;
      border: 1px solid rgba(148,163,184,0.2);
      background-color: rgba(255,255,255,0.95);
      color: #0f1720;
    }
    .styled-form input:focus {
      outline: none;
      box-shadow: 0 0 0 4px rgba(250,204,21,0.12);
      border-color: rgba(250,204,21,0.8);
    }
    /* Small helper for error text */
    .styled-form p { margin: 0; }
  </style>

  <script>
    // Password visibility toggles
    (function(){
      function toggle(idBtn, inputSelector) {
        const btn = document.getElementById(idBtn);
        if (!btn) return;
        btn.addEventListener('click', function(){
          const input = document.querySelector(inputSelector);
          if (!input) return;
          if (input.type === 'password') { input.type = 'text'; btn.textContent = 'ซ่อน'; }
          else { input.type = 'password'; btn.textContent = 'แสดง'; }
        });
      }
      // Try common name patterns for Django-generated inputs
      toggle('toggle-pass1', 'input[name$="password1"], input#id_password1');
      toggle('toggle-pass2', 'input[name$="password2"], input#id_password2');
    })();
  </script>
</div>
{% endblock %}
